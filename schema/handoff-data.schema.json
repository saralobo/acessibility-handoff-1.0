{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Accessibility Handoff Data",
  "description": "Strict schema for AI-generated accessibility annotation data. The AI produces this JSON; the build script consumes it to create identical Figma output every time.",
  "type": "object",
  "required": ["screen", "template", "annotations"],
  "properties": {
    "screen": {
      "type": "object",
      "description": "The screen being annotated.",
      "required": ["name", "nodeId"],
      "properties": {
        "name": { "type": "string", "description": "Human-readable screen name (e.g., 'Payment')" },
        "nodeId": { "type": "string", "description": "Figma node ID of the screen to clone (e.g., '1:221')" },
        "figmaUrl": { "type": "string", "description": "Optional full Figma URL for reference" }
      }
    },
    "template": {
      "type": "object",
      "description": "Metadata for the hand-off template header.",
      "required": ["headline", "title", "description", "flowName"],
      "properties": {
        "headline": { "type": "string", "description": "Uppercase category label (e.g., 'CHECKOUT FLOW')" },
        "title": { "type": "string", "description": "Flow title displayed large (e.g., 'Payment')" },
        "description": { "type": "string", "description": "Context description" },
        "subflowLabel": { "type": "string", "default": "Sub-flow", "description": "Sidebar label text" },
        "flowName": { "type": "string", "description": "Name for the dark flow section" }
      }
    },
    "annotations": {
      "type": "array",
      "description": "Ordered list of accessibility annotations. All label cards appear on the RIGHT side of the screen. Each annotation SHOULD include targetBounds for accurate highlight placement.",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["order", "componentName", "tagType", "accessibilityName", "role"],
        "properties": {
          "order": { "type": "integer", "minimum": 0, "description": "Reading order number for badge. Use 0 for Group/Ignore (no badge)." },
          "componentName": { "type": "string", "description": "Human name of the target component" },
          "tagType": { "type": "string", "enum": ["Button", "Label", "H", "Group", "Ignore"], "description": "Button=green, Label=blue, H=purple, Group=red outline, Ignore=gray hatched overlay" },
          "accessibilityName": { "type": "string", "description": "What the screen reader announces" },
          "role": { "type": "string", "description": "ARIA role or element type" },
          "state": { "type": "string", "description": "Optional state/action (Button tags only)" },
          "targetNodeId": { "type": "string", "description": "Optional Figma node ID for programmatic position detection" },
          "targetBounds": {
            "type": "object",
            "description": "Approximate bounds of the component on the device screen, as proportions (0.0 to 1.0) of the device frame. x=0.0 is left edge, y=0.0 is top edge, width=1.0 is full device width, height=1.0 is full device height. The AI MUST estimate these from the screenshot to get accurate highlight placement. Without this, highlights are skipped.",
            "properties": {
              "x": { "type": "number", "minimum": 0, "maximum": 1, "description": "Left edge as proportion of device width" },
              "y": { "type": "number", "minimum": 0, "maximum": 1, "description": "Top edge as proportion of device height" },
              "width": { "type": "number", "minimum": 0, "maximum": 1, "description": "Width as proportion of device width" },
              "height": { "type": "number", "minimum": 0, "maximum": 1, "description": "Height as proportion of device height" }
            },
            "required": ["x", "y", "width", "height"]
          }
        }
      }
    }
  }
}